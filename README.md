# bbtape
## Внешняя сортировка слиянием для устройства типа лента

### Содержимое ленты (T)
Требования к содержимому ленты:
* Тип должен быть копируемым, перемещаемым
* Тип должен поддерживать операции сравнения
* Тип должен поддерживаться nlohmann::json

### Алгоритм сортировки
#### 1. Разбиение файлов
Разбиение исходного файла на фрагменты размера ```M / sizeof(T)```, где M - размер ОЗУ в байтах.
Алгоритм разбиения на псевдокоде:
```
пока количество файлов не будет достигнуто:
      создать временный файл
      поместить временный файл в держатель

      если нельзя считать в ОЗУ:
            переход к следующей итерации

      запись в ОЗУ из исходного файла
      сортировка ОЗУ
      запись во временный файл из ОЗУ
```
Гарантируется четное количество файлов на выходе.

#### 2. Слияние
```
пока количество файлов в держателе больше 1:
      держатель = стратегия_сортировки(держатель, ...)

      изменение размера блока ОЗУ при условии
      изменение количества потоков при условии
```
На каждом шаге, кроме последнего, гарантируется четное количество файлов.

cmake -DCMAKE_C_COMPILER=/opt/homebrew/Cellar/gcc/14.2.0_1/bin/gcc-14 \
      -DCMAKE_CXX_COMPILER=/opt/homebrew/Cellar/gcc/14.2.0_1/bin/g++-14 \
      -DCMAKE_BUILD_TYPE=Release \
      ..
